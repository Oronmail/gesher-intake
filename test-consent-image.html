<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Consent Image Generation</title>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body style="padding: 20px; background: #f3f4f6;">
    <h1 style="text-align: center;">בדיקת יצירת תמונת הסכמה</h1>
    
    <div id="test-form" style="
        width: 800px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    ">
        <div style="
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: bold;
        ">
            <div>נחתם דיגיטלית</div>
            <div style="font-size: 11px; margin-top: 4px;">11/09/2025 | 18:45:30</div>
            <div style="font-size: 10px; margin-top: 2px;">REF-202509-TEST</div>
        </div>
        
        <h2 style="text-align: center; color: #2563eb;">גשר אל הנוער</h2>
        <p style="text-align: center;">טופס הסכמת הורים</p>
        
        <div style="background: #f9fafb; padding: 20px; margin: 20px 0; border-radius: 8px;">
            <p><strong>שם התלמיד:</strong> דוד ישראלי</p>
            <p><strong>מספר הפניה:</strong> REF-202509-TEST</p>
        </div>
        
        <div style="border: 2px solid #e5e7eb; padding: 20px; margin: 20px 0; border-radius: 8px;">
            <h3>הורה 1</h3>
            <p><strong>שם:</strong> יעקב ישראלי</p>
            <p><strong>ת.ז.:</strong> 123456789</p>
            <p><strong>כתובת:</strong> רחוב הרצל 10, תל אביב</p>
            <p><strong>חתימה:</strong> [חתימה דיגיטלית]</p>
        </div>
        
        <div style="background: #fef3c7; border-right: 4px solid #f59e0b; padding: 20px; margin: 20px 0;">
            <h3 style="color: #92400e;">הצהרת הסכמה</h3>
            <p>אני נותן את הסכמתי המלאה לעמותת גשר אל הנוער לטפל בנתוני ילדי.</p>
        </div>
    </div>
    
    <div style="text-align: center; margin-top: 40px;">
        <button onclick="generateImage()" style="
            background: #2563eb;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
        ">צור תמונת הסכמה</button>
    </div>
    
    <div id="result" style="margin-top: 40px; text-align: center;"></div>
    
    <script>
        async function generateImage() {
            const element = document.getElementById('test-form');
            const resultDiv = document.getElementById('result');
            
            try {
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                resultDiv.innerHTML = '<h3>תמונה נוצרה בהצלחה:</h3>';
                resultDiv.appendChild(canvas);
                
                // Check if Hebrew text rendered correctly
                const imageData = canvas.toDataURL('image/png');
                console.log('Image size:', Math.round(imageData.length / 1024), 'KB');
                
                // Add download link
                const link = document.createElement('a');
                link.href = imageData;
                link.download = 'consent-test.png';
                link.textContent = 'הורד תמונה';
                link.style.display = 'block';
                link.style.marginTop = '20px';
                link.style.color = '#2563eb';
                resultDiv.appendChild(link);
                
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">שגיאה: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>